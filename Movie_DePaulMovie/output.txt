
+------+---------+-------+--------+---------+--------+---------+-----+------+
|userid|itemid   |Time   |Location|Companion|Event   |EventType|Value|Weight|
+------+---------+-------+--------+---------+--------+---------+-----+------+
|1001  |tt0088763|NA     |NA      |NA       |Like    |2        |1    |3     |
|1001  |tt0088763|Weekend|Cinema  |Family   |Purchase|3        |1    |5     |
|1001  |tt0088763|Weekend|Cinema  |Family   |Like    |2        |1    |3     |
|1001  |tt0088763|Weekend|Cinema  |Family   |View    |1        |2    |1     |
|1001  |tt0088763|Weekend|Cinema  |Partner  |Purchase|3        |2    |5     |
|1001  |tt0088763|Weekend|Cinema  |Partner  |Like    |2        |1    |3     |
|1001  |tt0088763|Weekend|Cinema  |Partner  |View    |1        |3    |1     |
|1001  |tt0111161|NA     |NA      |NA       |Purchase|3        |5    |5     |
|1001  |tt0111161|NA     |NA      |NA       |Like    |2        |1    |3     |
|1001  |tt0111161|NA     |NA      |NA       |View    |1        |1    |1     |
|1001  |tt0111161|Weekend|Cinema  |Family   |Purchase|3        |2    |5     |
|1001  |tt0111161|Weekend|Cinema  |Family   |Like    |2        |1    |3     |
|1001  |tt0111161|Weekend|Cinema  |Family   |View    |1        |1    |1     |
|1001  |tt0111161|Weekend|Cinema  |Partner  |Purchase|3        |2    |5     |
|1001  |tt0111161|Weekend|Cinema  |Partner  |Like    |2        |1    |3     |
|1001  |tt0111161|Weekend|Cinema  |Partner  |View    |1        |3    |1     |
|1001  |tt0120338|NA     |NA      |NA       |Purchase|3        |3    |5     |
|1001  |tt0120338|NA     |NA      |NA       |Like    |2        |1    |3     |
|1001  |tt0120338|NA     |NA      |NA       |View    |1        |1    |1     |
|1001  |tt0120338|Weekend|Cinema  |Alone    |Like    |2        |1    |3     |
+------+---------+-------+--------+---------+--------+---------+-----+------+
only showing top 20 rows

root
 |-- userid: integer (nullable = true)
 |-- itemid: string (nullable = true)
 |-- Time: string (nullable = true)
 |-- Location: string (nullable = true)
 |-- Companion: string (nullable = true)
 |-- Event: string (nullable = true)
 |-- EventType: integer (nullable = true)
 |-- Value: integer (nullable = true)
 |-- Weight: integer (nullable = true)

+------+---------+-------+--------+---------+------+
|userid|itemid   |Time   |Location|Companion|rating|
+------+---------+-------+--------+---------+------+
|1007  |tt1055369|Weekday|Home    |Family   |16    |
|1015  |tt1707386|Weekday|Home    |Alone    |6     |
|1026  |tt0181689|Weekday|Home    |Alone    |25    |
|1028  |tt0114369|Weekday|Cinema  |Family   |51    |
|1028  |tt0367594|Weekend|Cinema  |Alone    |23    |
|1029  |tt0181689|NA     |NA      |NA       |18    |
|1045  |tt0319262|Weekday|Cinema  |Family   |21    |
|1047  |tt0945513|NA     |NA      |NA       |13    |
|1047  |tt1375666|Weekday|Cinema  |Alone    |3     |
|1047  |tt1657301|NA     |NA      |NA       |6     |
|1047  |ttnanana1|NA     |NA      |NA       |10    |
|1049  |tt1478338|Weekend|Home    |Partner  |6     |
|1055  |tt0378194|Weekday|Home    |Alone    |4     |
|1060  |tt0343660|Weekend|Cinema  |Partner  |43    |
|1070  |tt1375666|Weekend|Cinema  |Family   |15    |
|1078  |tt1564367|Weekday|Cinema  |Family   |19    |
|1082  |tt0110475|Weekend|Home    |Family   |26    |
|1082  |tt1453405|NA     |NA      |NA       |5     |
|1087  |tt1499658|Weekday|Cinema  |Family   |46    |
|1109  |tt2096673|Weekday|Home    |Family   |35    |
+------+---------+-------+--------+---------+------+
only showing top 20 rows

root
 |-- userid: integer (nullable = true)
 |-- itemid: string (nullable = true)
 |-- Time: string (nullable = true)
 |-- Location: string (nullable = true)
 |-- Companion: string (nullable = true)
 |-- rating: long (nullable = true)

+------+---------+-------+--------+---------+------+-------------+-------------+
|userid|itemid   |Time   |Location|Companion|rating|itemidIndexed|useridIndexed|
+------+---------+-------+--------+---------+------+-------------+-------------+
|1007  |tt1055369|Weekday|Home    |Family   |16    |23.0         |80.0         |
|1015  |tt1707386|Weekday|Home    |Alone    |6     |25.0         |27.0         |
|1026  |tt0181689|Weekday|Home    |Alone    |25    |24.0         |45.0         |
|1028  |tt0114369|Weekday|Cinema  |Family   |51    |22.0         |22.0         |
|1028  |tt0367594|Weekend|Cinema  |Alone    |23    |43.0         |22.0         |
|1029  |tt0181689|NA     |NA      |NA       |18    |24.0         |60.0         |
|1045  |tt0319262|Weekday|Cinema  |Family   |21    |15.0         |42.0         |
|1047  |tt0945513|NA     |NA      |NA       |13    |57.0         |9.0          |
|1047  |tt1375666|Weekday|Cinema  |Alone    |3     |2.0          |9.0          |
|1047  |tt1657301|NA     |NA      |NA       |6     |5.0          |9.0          |
|1047  |ttnanana1|NA     |NA      |NA       |10    |34.0         |9.0          |
|1049  |tt1478338|Weekend|Home    |Partner  |6     |26.0         |32.0         |
|1055  |tt0378194|Weekday|Home    |Alone    |4     |29.0         |34.0         |
|1060  |tt0343660|Weekend|Cinema  |Partner  |43    |16.0         |30.0         |
|1070  |tt1375666|Weekend|Cinema  |Family   |15    |2.0          |33.0         |
|1078  |tt1564367|Weekday|Cinema  |Family   |19    |70.0         |16.0         |
|1082  |tt0110475|Weekend|Home    |Family   |26    |66.0         |0.0          |
|1082  |tt1453405|NA     |NA      |NA       |5     |39.0         |0.0          |
|1087  |tt1499658|Weekday|Cinema  |Family   |46    |37.0         |7.0          |
|1109  |tt2096673|Weekday|Home    |Family   |35    |49.0         |62.0         |
+------+---------+-------+--------+---------+------+-------------+-------------+
only showing top 20 rows

root
 |-- userid: integer (nullable = true)
 |-- itemid: string (nullable = true)
 |-- Time: string (nullable = true)
 |-- Location: string (nullable = true)
 |-- Companion: string (nullable = true)
 |-- rating: long (nullable = true)
 |-- itemidIndexed: double (nullable = true)
 |-- useridIndexed: double (nullable = true)

Got 1823 ratings from 79 users on 79 movies.
Training: 1460, test: 363
Best model RMSE = 23.36335040991361
meanRating 27.31986301369863 baselineRMSE 16.8130448606384 best model RMSE 23.36335040991361
The best model improves the baseline by -38,96%.
+-------------+-------------------------------------------------------------------------------+
|useridIndexed|recommendations                                                                |
+-------------+-------------------------------------------------------------------------------+
|31           |[[33,47.847694], [30,44.04207], [52,38.85647], [53,38.65113], [12,32.855927]]  |
|65           |[[43,56.09721], [9,53.389584], [22,51.958546], [0,51.88127], [2,50.442913]]    |
|53           |[[3,71.38953], [34,62.072987], [32,58.36407], [15,54.107193], [20,52.35404]]   |
|78           |[[2,48.67741], [1,47.44834], [36,47.43253], [53,46.020325], [19,45.232174]]    |
|34           |[[34,103.10297], [33,81.99395], [11,75.37437], [5,69.16645], [49,67.336266]]   |
|28           |[[57,49.717228], [14,47.400887], [40,46.480564], [32,43.91385], [49,39.049694]]|
|76           |[[48,66.52089], [1,55.9008], [19,54.716], [45,54.558483], [33,53.89914]]       |
|26           |[[53,52.22089], [34,47.497837], [11,42.25325], [33,41.482197], [28,39.9732]]   |
|44           |[[25,67.46311], [48,65.08484], [35,61.382942], [63,55.920513], [23,45.480637]] |
|12           |[[52,54.05067], [12,50.50154], [53,47.728283], [19,44.968254], [20,44.00582]]  |
|22           |[[8,52.72194], [56,50.342125], [11,48.529247], [9,47.128754], [28,44.744194]]  |
|47           |[[3,55.055122], [52,52.309174], [5,50.349003], [29,48.410675], [1,46.35804]]   |
|1            |[[1,50.208282], [23,45.868977], [48,44.683647], [5,44.665733], [14,42.05484]]  |
|52           |[[25,55.76027], [0,53.801113], [4,48.95631], [40,48.60753], [26,46.04642]]     |
|13           |[[36,50.605457], [47,47.16625], [9,41.38322], [64,34.22789], [8,33.231735]]    |
|6            |[[28,56.96667], [2,56.834133], [58,54.30852], [45,53.15997], [19,49.13913]]    |
|16           |[[51,46.947807], [56,46.51237], [23,42.654716], [2,39.43366], [6,38.520493]]   |
|3            |[[61,43.55298], [8,41.098557], [9,40.411957], [51,39.766155], [36,37.73266]]   |
|20           |[[36,74.10661], [40,65.488266], [20,51.94342], [64,50.591026], [9,49.54283]]   |
|40           |[[45,43.39311], [52,41.010338], [2,40.987495], [9,40.155663], [29,39.155567]]  |
+-------------+-------------------------------------------------------------------------------+
only showing top 20 rows

+-------------+--------------------------------------------------------------------------------+
|itemidIndexed|recommendations                                                                 |
+-------------+--------------------------------------------------------------------------------+
|31           |[[42,42.9097], [47,40.81139], [8,39.143208], [80,38.881123], [39,36.110733]]    |
|65           |[[33,66.53557], [42,60.586433], [63,57.086445], [35,54.28817], [0,47.142143]]   |
|53           |[[26,52.22089], [45,51.392994], [46,49.10953], [63,48.25506], [12,47.728283]]   |
|78           |[[46,23.5967], [18,16.311314], [35,14.274557], [22,14.210504], [8,13.509327]]   |
|34           |[[34,103.10297], [75,79.665474], [53,62.072987], [70,52.350746], [33,51.842995]]|
|28           |[[18,57.197845], [6,56.96667], [74,53.97758], [9,52.205734], [24,49.10283]]     |
|76           |[[42,38.0602], [29,32.765976], [41,32.535374], [53,31.51655], [33,30.316252]]   |
|26           |[[19,55.0423], [74,50.15286], [17,49.25378], [41,47.54581], [65,46.25199]]      |
|27           |[[33,48.2584], [8,44.933487], [0,39.25586], [42,37.965225], [48,37.914497]]     |
|44           |[[9,54.35464], [75,45.61304], [53,42.43782], [37,40.96915], [68,37.870304]]     |
|12           |[[12,50.50154], [45,48.808346], [78,39.37388], [76,38.331306], [63,37.942566]]  |
|22           |[[42,62.054512], [37,52.83938], [65,51.958546], [9,49.08449], [18,48.83036]]    |
|47           |[[42,69.28581], [38,65.06612], [33,58.145027], [19,53.020103], [74,51.639732]]  |
|1            |[[76,55.9008], [17,54.744816], [37,51.351562], [1,50.208282], [78,47.44834]]    |
|52           |[[9,60.84629], [12,54.05067], [75,52.939194], [76,52.686146], [47,52.309174]]   |
|13           |[[15,62.93596], [75,50.441563], [51,47.64822], [0,47.58838], [23,45.93412]]     |
|6            |[[56,51.04444], [63,50.372223], [54,44.864254], [38,43.558556], [71,43.48728]]  |
|16           |[[80,55.94554], [9,46.71437], [19,41.52372], [53,41.05188], [29,40.798153]]     |
|3            |[[53,71.38953], [9,57.280697], [80,56.081898], [47,55.055122], [29,50.522785]]  |
|20           |[[63,76.296974], [71,61.461937], [53,52.35404], [20,51.94342], [0,50.9186]]     |
+-------------+--------------------------------------------------------------------------------+
only showing top 20 rows


Process finished with exit code 0
